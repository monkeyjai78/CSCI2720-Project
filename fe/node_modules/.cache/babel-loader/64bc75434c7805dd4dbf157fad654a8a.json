{"ast":null,"code":"var _jsxFileName = \"D:\\\\CUHK\\\\year3\\\\year3 sem2\\\\CSCI2720\\\\CSCI2720 Project\\\\project\\\\fe\\\\src\\\\pages\\\\Hours\\\\index.jsx\";\n//Group members\n//Hung Man Kei   (1155127099)\t Ng Megan Hoi Ling (1155124894)\n//Ching Sze Yuen (1155126621)    Tsai Kwun Ki      (1155126289)\nimport React, { useEffect, useState } from 'react';\nimport Lines from './../../component/Lines';\nimport { _getTenData, _getDaysData } from \"../../util/req\";\nimport dayjs from \"dayjs\";\n\nfunction gettimes() {\n  var arr = [];\n\n  for (let index = 0; index < 41; index++) {\n    var hs = dayjs().subtract(15 * index, 'minute').format(\"YYYYMMDD-HHmm\");\n    arr.push(hs);\n  }\n\n  arr = arr.map(it => {\n    var hs = it.slice(0, 11);\n    var cum = it.slice(11, 13);\n    var cm = Number(cum) - Number(cum) % 15;\n    return hs + (cm < 9 ? '0' + cm : cm);\n  });\n  return arr;\n}\n\nconst flatten = (arr, depth = 1) => arr.reduce((a, v) => a.concat(depth > 1 && Array.isArray(v) ? flatten(v, depth - 1) : v), []);\n\nconst groupBy = (arr, fn) => arr.map(typeof fn === 'function' ? fn : val => val[fn]).reduce((acc, val, i) => {\n  acc[val] = (acc[val] || []).concat(arr[i]);\n  return acc;\n}, {});\n\nfunction Index({\n  center,\n  initLinekers\n}) {\n  const [info, setInfo] = useState({\n    labels: [],\n    datas: []\n  });\n  const [info7, setInfo7] = useState({\n    labels: [],\n    datas: []\n  });\n  useEffect(() => {\n    const getInfo = async () => {\n      var res = await _getTenData();\n      var data = fordata(res.data);\n      var dayres = await _getDaysData();\n      var daydata = fordata(dayres.data);\n      setInfo(data);\n      setInfo7(daydata);\n    };\n\n    getInfo();\n  }, []);\n\n  const fordata = data => {\n    var labels = data.map(it => it.updateTime);\n    var waitTimes = flatten(data.map(it => it.waitTime), 3);\n    var dataObe = groupBy(waitTimes, 'hospName');\n    var data = [];\n\n    for (const key in dataObe) {\n      var obj = {};\n\n      if (Object.hasOwnProperty.call(dataObe, key)) {\n        const element = dataObe[key];\n        obj.label = key;\n        obj.data = element.map(it => it.topWait);\n        data.push(obj);\n      }\n    }\n\n    data = data.map(it => ({ ...it,\n      data: it.data.map(i => i.replace(/[^0-9]/ig, \"\"))\n    }));\n    return {\n      labels,\n      datas: data\n    };\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"info-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, \"10hours\"), /*#__PURE__*/React.createElement(Lines, Object.assign({}, info, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, \"7days\"), /*#__PURE__*/React.createElement(Lines, Object.assign({}, info7, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  })));\n}\n\nexport default Index;","map":{"version":3,"sources":["D:/CUHK/year3/year3 sem2/CSCI2720/CSCI2720 Project/project/fe/src/pages/Hours/index.jsx"],"names":["React","useEffect","useState","Lines","_getTenData","_getDaysData","dayjs","gettimes","arr","index","hs","subtract","format","push","map","it","slice","cum","cm","Number","flatten","depth","reduce","a","v","concat","Array","isArray","groupBy","fn","val","acc","i","Index","center","initLinekers","info","setInfo","labels","datas","info7","setInfo7","getInfo","res","data","fordata","dayres","daydata","updateTime","waitTimes","waitTime","dataObe","key","obj","Object","hasOwnProperty","call","element","label","topWait","replace"],"mappings":"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","sourcesContent":["//Group members\r\n//Hung Man Kei   (1155127099)\t Ng Megan Hoi Ling (1155124894)\r\n//Ching Sze Yuen (1155126621)    Tsai Kwun Ki      (1155126289)\r\n\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nimport Lines from './../../component/Lines';\r\nimport { _getTenData, _getDaysData } from \"../../util/req\";\r\nimport dayjs from \"dayjs\";\r\n\r\n\r\n\r\nfunction gettimes() {\r\n    var arr = []\r\n    for (let index = 0; index < 41; index++) {\r\n        var hs = dayjs().subtract(15 * index, 'minute').format(\"YYYYMMDD-HHmm\")\r\n        arr.push(hs)\r\n    }\r\n    arr = arr.map(it => {\r\n        var hs = it.slice(0, 11)\r\n        var cum = it.slice(11, 13)\r\n        var cm = Number(cum) - (Number(cum) % 15)\r\n        return hs + (cm < 9 ? '0' + cm : cm)\r\n    })\r\n    return arr\r\n}\r\n\r\n\r\nconst flatten = (arr, depth = 1) =>\r\n    arr.reduce((a, v) => a.concat(depth > 1 && Array.isArray(v) ? flatten(v, depth - 1) : v), []);\r\n\r\nconst groupBy = (arr, fn) =>\r\n    arr.map(typeof fn === 'function' ? fn : val => val[fn]).reduce((acc, val, i) => {\r\n        acc[val] = (acc[val] || []).concat(arr[i]);\r\n        return acc;\r\n    }, {});\r\n\r\n\r\n\r\nfunction Index({ center, initLinekers }) {\r\n    const [info, setInfo] = useState({\r\n        labels: [],\r\n        datas: [],\r\n    });\r\n    const [info7, setInfo7] = useState({\r\n        labels: [],\r\n        datas: [],\r\n    });\r\n    useEffect(() => {\r\n        const getInfo = async () => {\r\n            var res = await _getTenData()\r\n            var data = fordata(res.data)\r\n            var dayres = await _getDaysData()\r\n            var daydata = fordata(dayres.data)\r\n            setInfo(data)\r\n            setInfo7(daydata)\r\n        };\r\n        getInfo();\r\n    }, []);\r\n\r\n\r\n    const fordata = (data) => {\r\n        var labels = data.map(it => it.updateTime)\r\n        var waitTimes = flatten(data.map(it => it.waitTime), 3)\r\n\r\n        var dataObe = groupBy(waitTimes, 'hospName')\r\n        var data = []\r\n        for (const key in dataObe) {\r\n            var obj = {}\r\n            if (Object.hasOwnProperty.call(dataObe, key)) {\r\n                const element = dataObe[key];\r\n                obj.label = key\r\n                obj.data = element.map(it => it.topWait)\r\n                data.push(obj)\r\n            }\r\n        }\r\n        data = data.map(it => ({ ...it, data: it.data.map(i => i.replace(/[^0-9]/ig, \"\")) }))\r\n        return {\r\n            labels,\r\n            datas: data,\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"info-center\">\r\n            <p>\r\n                10hours\r\n            </p>\r\n            <Lines {...info} />\r\n            <p>\r\n                7days\r\n            </p>\r\n            <Lines {...info7} />\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Index;\r\n"]},"metadata":{},"sourceType":"module"}